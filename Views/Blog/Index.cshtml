@model Blog.Models.ViewModels.BlogIndexViewModel
@using Blog.Models.ViewModels
@{
    var role = Context.Session.GetString("UserRole");
}
@{
    string ActiveClass(string? category) =>
        Model.SelectedCategory == category
            ? "bg-purple-700 text-white border-purple-700"
            : "text-purple-700 border-purple-700 hover:bg-purple-950/50";
}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="//unpkg.com/alpinejs" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>IT Blogs</title>
</head>
<body class="h-full bg-zinc-950">
<div class="min-h-full">
    <nav class="bg-zinc-950 mt-1">
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 border border-white/10 rounded-full">
            <div class="flex h-16 items-center justify-between">
                <div class="flex items-center">
                    <div class="shrink-0">
                        <h1 class="text-white font-medium px-3 py-2 bg-purple-900/40 rounded-full "> 🖳 IT Blogs</h1>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a asp-controller="Blog" asp-action="Index" class="text-purple-700 rounded-md font-bold hover:text-purple-500">Blogs</a>
                            <a asp-controller="About" asp-action="Index" class="text-purple-700 rounded-md font-bold hover:text-purple-500">About</a>
                        </div>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center md:ml-6">
                        @if (ViewContext.HttpContext.Session.GetInt32("UserId") != null)
                        {
                            <a asp-controller="Auth" asp-action="Profile" class="text-white bg-purple-900/40 rounded-md px-3 py-2 text-sm font-medium hover:bg-purple-500">Profile</a>
                        }
                        else
                        {
                            <a asp-controller="Auth" asp-action="Login" class="text-white bg-purple-900/40 rounded-md px-3 py-2 text-sm font-medium hover:bg-purple-500">Login</a>
                        }
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <header class="relative bg-zinc-950 after:pointer-events-none after:absolute after:inset-x-0 after:inset-y-0">
        <div class="mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8">
            <h1 class="text-3xl font-bold tracking-tight text-white">All Blogs</h1>
        </div>
    </header>

    <main>
        <div class="mx-auto max-w-7xl px-6 py-6 sm:px-6 lg:px-8">
            <div class="bg-gradient-to-r from-violet-950/10 to-purple-900/40 px-10 py-10 rounded-lg w-full shadow-lg shadow-black/50">
                <h1 class="text-5xl font-bold tracking-tight text-white">IT Blog</h1>
                <p class="text-white mt-6">Here, we explore insights, experiences, and perspectives that aim to inform, inspire, and spark meaningful conversations.<br>
                    Take your time, read freely, and feel at home.</p>
            </div>

            <div class="grid grid-cols-2 gap-4 mt-6">
                <div class="bg-neutral-800/30 p-8 rounded-md text-center shadow-lg shadow-black/50">
                    <h1 class="text-5xl font-bold tracking-tight text-purple-700">@Model.TotalBlogs</h1>
                    <p class="text-white/60">Blogs</p>
                </div>
                <div class="bg-neutral-800/30 p-8 rounded-md text-center shadow-lg shadow-black/50">
                    <h1 class="text-5xl font-bold tracking-tight text-purple-700">@Model.TotalUsers</h1>
                    <p class="text-white/60">Users</p>
                </div>
            </div>

            <div class="grid grid-cols-5 gap-5 text-center">

                <a asp-controller="Blog" asp-action="Index"
                   class="mt-6 font-semibold border-2 px-5 py-1 rounded-md @ActiveClass(null)">
                    All Categories
                </a>

                <a asp-controller="Blog" asp-action="Index" asp-route-category="Software Engineering"
                   class="mt-6 font-semibold border-2 px-5 py-1 rounded-md @ActiveClass("Software Engineering")">
                    Software Engineering
                </a>

                <a asp-controller="Blog" asp-action="Index" asp-route-category="Artificial Intelligence"
                   class="mt-6 font-semibold border-2 px-5 py-1 rounded-md @ActiveClass("Artificial Intelligence")">
                    Artificial Intelligence
                </a>

                <a asp-controller="Blog" asp-action="Index" asp-route-category="Computer Science"
                   class="mt-6 font-semibold border-2 px-5 py-1 rounded-md @ActiveClass("Computer Science")">
                    Computer Science
                </a>

                <a asp-controller="Blog" asp-action="Index" asp-route-category="Cybersecurity"
                   class="mt-6 font-semibold border-2 px-5 py-1 rounded-md @ActiveClass("Cybersecurity")">
                    Cybersecurity
                </a>
            </div>
            
            <div class="flex justify-center mb-4 text-center">
                <a asp-controller="Blog" asp-action="Create" class="mt-6 text-white bg-purple-900/40 font-semibold w-full px-5 py-2 rounded-md hover:bg-purple-950/50">+ Create New Blog</a>
            </div>

            <div x-data="{ show: false }" x-init="setTimeout(() => show = true, 300)">
                    <div x-cloak
                         x-show="show"
                         x-transition:enter="transition ease-out duration-1000"
                         x-transition:enter-start="opacity-0 scale-90"
                         x-transition:enter-end="opacity-100 scale-100">

                    @if (Model == null || !Model.Blogs.Any())
                    {
                        <div class="text-center">
                            <h1 class="text-2xl text-white">No blogs yet.</h1>
                        </div>
                    }
                    else
                    {
                        @foreach (var blog in Model.Blogs)
                        {

                            <div class="bg-neutral-800/30 p-8 rounded-md grid grid-cols-6 gap-4 mb-4 shadow-lg border-2 border-zinc-950 shadow-black/50 hover:border-purple-900 transition duration-300">
                                <div class="col-start-1 col-end-3">
                                    <a asp-controller="Blog" asp-action="Show" asp-route-id="@blog.Id" class="text-white text-2xl font-bold mb-3">@blog.Title</a>
                                    <p class="text-purple-700 text-sm font-bold">Author: @blog.Author?.Name</p>
                                </div>
                                @if (role == "Admin")
                                {
                                    <div class="flex-inline justify-self-end col-span-2 col-end-7 mt-5 space-x-4">
                                        <a asp-controller="Blog" asp-action="Edit" asp-route-id="@blog.Id" class="text-purple-700 hover:text-purple-500">Edit</a>
                                        <form asp-controller="Blog" asp-action="Delete" asp-route-id="@blog.Id" method="post" onsubmit="return confirm('Are you sure you want to delete this blog?');" class="inline">
                                            @Html.AntiForgeryToken()
                                            <button type="submit" class="text-purple-700 hover:text-purple-500">Delete</button>
                                        </form>
                                    </div>
                                }
                            </div>

                        }
                    }
                    </div>
                </div>
        </div>
    </main>
</div>
</body>
</html>

